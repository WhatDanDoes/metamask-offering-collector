<% include _partials/head %>
  <body>
    <header>
      <nav>
        <a id="home-link" href="/">
          <img alt="Logo" src="/images/offering-plate.png" height="70">
        </a>
        <ul>
          <li id="connect-metamask">
            <a href="/auth/disconnect">
              <button id="disconnect-metamask-button" type="submit">Disconnect Metamask</button>
            </a>
          </li>
        </ul>

      </nav>
      <h1>Accounts</h1>
      <h4>
        <%= !agents.length ? 'No one has logged in' : '' %>
      </h4>
      <br>
      <a href="/transaction">
        <button id="transaction-button">Transactions</button>
      </a>
      <% include _partials/messages %>
    </header>
    <main>
      <section>
        <table id="account-table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Last Seen</th>
              <th>Address</th>
            </tr>
          </thead>
          <tbody>
            <% for (let agent of agents) { %>
            <tr>
              <td><%= agent.name ? agent.name : '' %></td>
              <td><%= agent.updatedAt.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }) %></td>
              <td>
                <a href="/account/<%= agent.publicAddress %>" target="_blank">
                  <%= `${agent.publicAddress.slice(0, 4)}...${agent.publicAddress.slice(-3)}` %>
                </a>
              </td>
            </tr>
            <% } %>
          </tbody>
        </table>
      </section>

    </main>
  </body>
</html>
